{
  "kind": "build_request",
  "title": "Phase 2: Dual-Actor System Implementation",
  "projectName": "The Gang",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-33",
      "text": "Populate frontend/src/hooks/useActor.ts with dual-actor initialization logic: Initialize Actor 1 (Main Backend) with Identity and call _initializeAccessControlWithSecret, then initialize Actor 2 (Telemetry Actor) inside a try/catch block using dynamic import (await import('../../declarations/telemetry')), and return { actor, telemetryActor, isFetching }",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Populate frontend/src/hooks/useActor.ts with the following logic: Initialize Actor 1 (Main Backend) with Identity and _initializeAccessControlWithSecret. Initialize Actor 2 (Telemetry Actor) inside a try/catch block using dynamic imports (await import('../../../declarations/telemetry')). Return { actor, telemetryActor, isFetching }."
        ]
      },
      "acceptanceCriteria": [
        "useActor.ts initializes the main backend actor with Identity authentication",
        "useActor.ts calls _initializeAccessControlWithSecret on the main actor",
        "useActor.ts initializes the telemetry actor using dynamic import within a try/catch block",
        "useActor.ts returns an object containing actor, telemetryActor, and isFetching",
        "The telemetry actor import uses the correct relative path to declarations"
      ]
    },
    {
      "id": "REQ-34",
      "text": "Update frontend/src/hooks/useQueries.ts to remove all references to reset_agents() function",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Update frontend/src/hooks/useQueries.ts: Remove any reference to reset_agents()."
        ]
      },
      "acceptanceCriteria": [
        "All calls to reset_agents() are removed from useQueries.ts",
        "No import statements reference reset_agents",
        "The file compiles without errors after removal"
      ]
    },
    {
      "id": "REQ-35",
      "text": "Update the useResetAgents mutation in frontend/src/hooks/useQueries.ts to call actor.initializeAgents() instead of the previous reset_agents() function",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Update the useResetAgents mutation to call the original actor.initializeAgents() function."
        ]
      },
      "acceptanceCriteria": [
        "useResetAgents mutation calls actor.initializeAgents()",
        "The mutation still invalidates the agentStatuses query upon success",
        "The Reset Agents button in AgentRegistryTable.tsx continues to function correctly"
      ]
    },
    {
      "id": "REQ-36",
      "text": "Run dfx generate telemetry command to generate declarations for the telemetry canister before completing the build",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Final Command: Run dfx generate telemetry to ensure declarations exist before the build completes."
        ]
      },
      "acceptanceCriteria": [
        "dfx generate telemetry executes successfully",
        "Telemetry canister declarations are generated in the declarations directory",
        "The generated declarations are accessible for frontend import"
      ]
    }
  ],
  "constraints": [
    "Do not modify backend/main.mo (Golden Master v56)",
    "Preserve existing useActor.ts hook interface expectations throughout the codebase",
    "Maintain backward compatibility with existing query hooks in useQueries.ts"
  ],
  "nonGoals": [
    "Creating new backend functions or modifying backend logic",
    "Adding new UI components or visual changes",
    "Implementing actual telemetry data flow or agent communication"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}